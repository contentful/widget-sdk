@require '../mixins/spinner'

/*
Buttons

Markup:
script
  | $(function () {
  |   $('button.is-loading').on('click', function() {
  |     $(this).toggleClass('is-loading');
  |   });
  | });


Styleguide 4.0
*/

// Legacy classes for disabled buttons
.transparent-button-layer
  background-color: transparent
  position: absolute
  $layer('buttonOverlay')
  margin: 0 !important

.transparent-button
  background: none
  border: none
  cursor: pointer
  padding: 0
  margin: 0
.transparent-button[disabled]
  cursor: auto

$button-reset()
  color: inherit
  font: inherit
  font-size: inherit
  line-height: normal
  vertical-align: baseline
  padding: 0
  margin: 0
  border: 0
  background: none
  overflow: visible
  user-select: none
  cursor: pointer
  &::-moz-focus-inner
    border: 0
    padding: 0

button
  $button-reset()

$button($color, $text)
  $button-layout()
  $button-colors($color, $text)
  $button-loading($text)



/**
 * Applies layout and typography styles
 */
$button-vertical-padding = (10 / 16) * 1rem
$button-layout()
  display: inline-block
  padding: $button-vertical-padding 1.5rem
  cursor: pointer
  text-align: center
  font-size: .875rem
  font-weight: 500
  white-space: normal
  border: 1px solid transparent
  border-radius: 2px
  line-height: $base-line-height


$button-large()
  font-size: 1.15rem
  padding: .875rem 1.25rem

  > .btn-icon
    height: 0.8em

/**
 * Applies background, text and border colors for the various states.
 */
$button-colors($bg, $text)
  color: $text
  background: $bg
  background-size: 100% 200%
  transition-property: all
  transition-timing-function: ease-in-out
  transition-duration: 0.1s

  &:hover:not(:disabled)
    background-position: 0 100%

  &.active,&:active
    box-shadow: inset 0 1px 2px rgba(black, .12)


  // Reset for links
  &:link, a&:hover, a&:link, a&:visited
    color: $text

  &:disabled, &[aria-disabled=true], &.disabled
    opacity: 0.4
    cursor: default
    // This overides any other state styles, like hover or active
    background: $bg
    box-shadow: none


/**
 * Add a spinner pseude element and activate it in the `is-loading`
 * state.
 */
$button-loading($text)
  > *
    display: inline-block
  +$spinner-base()
    display: inline-block
  &.is-loading
    &:disabled
      opacity: 1
    +$spinner-active($text)
      margin-left: 5px


/*
Action/Secondary Button

This button should be used for actions which are important, but not necessarily
the most important action in the current view

Markup:
button.btn-action{{modifier_class}} Action
button.btn-action{{modifier_class}}.pseudo-class-hover Action
button.btn-action{{modifier_class}}.active Action
button.btn-action{{modifier_class}}(disabled) Action
button.btn-action{{modifier_class}}.is-loading Action
button.btn-action{{modifier_class}}
  cf-icon.btn-icon.inverted(name="plus")
  | Action
button.btn-action{{modifier_class}}.is-loading
  cf-icon.btn-icon.inverted(name="plus")
  | Action
button.btn-action{{modifier_class}}
  cf-icon.btn-dropdown-icon(name="dd-arrow-down")
  | Action
button.btn-action{{modifier_class}}
  cf-icon.btn-icon.inverted(name="plus")
  cf-icon.btn-dropdown-icon(name="dd-arrow-down")
  | Action

--large - Large variation

Styleguide 4.1
*/

$btn-action-bg = linear-gradient(to top, $colors.blue-dark, $colors.blue-light)
$btn-action()
  $button($btn-action-bg, white)
  border-color: $colors.blue-dark

  &:hover, &.active
    border-color: $colors.blue-darkest

.btn-action,
.btn-action--large
  $btn-action()

.btn-action--large
  $button-large()


/*
Primary Action Button

Used for the most important action in a given context

Markup:
button.btn-primary-action{{modifier_class}} Action
button.btn-primary-action{{modifier_class}}.pseudo-class-hover Action
button.btn-primary-action{{modifier_class}}.active Action
button.btn-primary-action{{modifier_class}}(disabled) Action
button.btn-primary-action{{modifier_class}}.is-loading Action
button.btn-primary-action{{modifier_class}}
  cf-icon.btn-icon.inverted(name="plus")
  | Action
button.btn-primary-action{{modifier_class}}.is-loading
  cf-icon.btn-icon.inverted(name="plus")
  | Action
button.btn-primary-action{{modifier_class}}
  cf-icon.btn-dropdown-icon(name="dd-arrow-down")
  | Action
button.btn-primary-action{{modifier_class}}
  cf-icon.btn-icon.inverted(name="plus")
  cf-icon.btn-dropdown-icon(name="dd-arrow-down")
  | Action

--large - Large variation

Styleguide 4.2
*/

$btn-primary-bg = linear-gradient(to top, $colors.green-dark, $colors.green-light)
$btn-primary()
  $button($btn-primary-bg, white)
  border-color: $colors.green-dark

  &:hover, &.active
    border-color: $colors.green-darkest

.btn-primary-action,
.btn-primary-action--large
  $btn-primary()

.btn-primary-action--large
  $button-large()

/*
Secondary Action Button

Used for actions that should complement primary actions or visually less
important actions

Markup:
button.btn-secondary-action{{modifier_class}} Action
button.btn-secondary-action{{modifier_class}}.pseudo-class-hover Action
button.btn-secondary-action{{modifier_class}}.active Action
button.btn-secondary-action{{modifier_class}}(disabled) Action
button.btn-secondary-action{{modifier_class}}.is-loading Action
button.btn-secondary-action{{modifier_class}}
  cf-icon.btn-icon.inverted(name="plus")
  | Action
button.btn-secondary-action{{modifier_class}}.is-loading
  cf-icon.btn-icon.inverted(name="plus")
  | Action
button.btn-secondary-action{{modifier_class}}
  cf-icon.btn-dropdown-icon(name="dd-arrow-down")
  | Action
button.btn-secondary-action{{modifier_class}}
  cf-icon.btn-icon.inverted(name="plus")
  cf-icon.btn-dropdown-icon(name="dd-arrow-down")
  | Action

--large - Large variation

Styleguide 4.3
*/
$btn-secondary-text = $colors.text-mid
$btn-secondary-bg = $colors.element-light
$button-secondary-colors()
  $button-colors($btn-secondary-bg, $btn-secondary-text)
  border-color: $colors.element-dark

  &:hover:not(:disabled), &.active
    background-color: $colors.element-mid
    border-color: $colors.element-darkest

.btn-secondary-action,
.btn-secondary-action--large
  $button($btn-secondary-bg, $btn-secondary-text)
  border-color: $colors.element-dark

  &:hover, &.active
    background-color: $colors.element-mid
    border-color: $colors.element-darkest

  > cf-icon[name="plus"]
    circle
      fill: $btn-secondary-text
    path
      stroke: $btn-secondary-bg

.btn-secondary-action--large
  $button-large()


/**
Caution button

Markup:
button.btn-caution Be Careful!
button.btn-caution.pseudo-class-hover Be Careful!
button.btn-caution.active Be Careful!
button.btn-caution(disabled) Be Careful!

Styleguide 4.4
*/
$btn-caution-bg = linear-gradient(to top, $colors.red-dark, $colors.red-light)
.btn-caution
  $button($btn-caution-bg, white)
  border-color: $colors.red-dark

  &:hover
    border-color: $colors.red-darkest


/**
Plain Action Button

TODO: Support `button.btn-plain.is-loading`, and `button.btn-plain(disabled)`

Markup:
button.btn-primary-action
  | One
button.btn-plain
  | Two
button.btn-action
  | Three

Styleguide 4.5
*/
$button-plain()
  background: none
  $button-layout()
  color: $colors.blue-darkest
  text-decoration: underline
  &:hover
    color: $colors.text-dark

.btn-plain
  $button-plain()

/**
Block button

Markup:
p
  | Normal
  button.btn-primary-action.x--block Action Button
p
  | Loading
  button.btn-primary-action.x--block.is-loading Loading
p
  | Icon
  button.btn-primary-action.x--block
    cf-icon.btn-icon.inverted(name="plus")
    | Action
p
  | Icon and loading
  button.btn-primary-action.x--block.is-loading
    cf-icon.btn-icon.inverted(name="plus")
    | Action
p
  | Dropdown
  button.btn-primary-action.x--block
    cf-icon.btn-dropdown-icon(name="dd-arrow-down")
    | Action
p
  | Icon and dropdown
  button.btn-primary-action.x--block
    cf-icon.btn-icon.inverted(name="plus")
    cf-icon.btn-dropdown-icon(name="dd-arrow-down")
    | Action

Styleguide 4.6
*/

$x--block()
  display: block
  width: 100%
  position: relative
  &:after
    position: absolute

  &.is-loading
    &:after
      // This overides the width and height transitions
      transition: opacity .2s linear
      top: 11px

.x--block
  $x--block()


// DEPRECATED
$btn-inline()
  font-size: inherit
  display: inline-block
  vertical-align: baseline
  padding: 0.1em 0.3em
  margin: 0
  border: 0
  background: none
  cursor: pointer
  color: $colors.blue

.btn-inline
  $btn-inline()


/**
Link Style Button

Markup:
button.btn-link
  | Action
button.btn-link(disabled)
  | Disabled
button.btn-link.is-loading
  | Loading
button.btn-link
  cf-icon.btn-icon(name="plus")
  | Action

Styleguide 4.7
*/

.btn-link
  $button-reset();
  display: block
  color: $colors.blue-dark
  transition: all ease-in-out .1s
  text-decoration: underline

  &:not(:disabled):hover
    color: $colors.text-dark
    background-color: transparent

  &:disabled, &--disabled
    cursor: not-allowed
    opacity: .5

  &:active, &--active
    box-shadow: none

  &__icon
    display: inline-block
    vertical-align: top
    margin-right: 0.4em
    > svg
      width: 18px
      height: 18px
      fill: $colors.blue-dark
    /*
    Partial Reference that transpiles to .btn-link:hover .btn-link__icon
    */  
    ^[0]:hover &
      > svg
        fill: $colors.text-dark

/*
Buttons with icons

Markup:
button.btn-action
  cf-icon.btn-icon.inverted(name="plus")
  | Action
button.btn-secondary-action
  cf-icon.btn-icon.inverted(name="plus")
  | Action
button.btn-plain
  cf-icon.btn-icon(name="plus")
  | Action
button.btn-action--large-popout-icon
  cf-icon(name="new-ct")
  | Action

Styleguide 4.8
*/

$btn-icon()
  display: inline-block
  height: 0.9em
  margin-right: 0.55em
  > svg
    display: block

.btn-icon
  $btn-icon()

.btn-icon-left
  


$button--large-popout-icon()
  $button-large()
  padding-left: 5.0rem
  cf-icon
    position: absolute
    left: 1.0rem
    top: -0.5rem

.btn-action--large-popout-icon
  position: relative
  $btn-action()
  $button--large-popout-icon()


/*
Buttons with dropdowns

Markup:
button.btn-secondary-action
  cf-icon.btn-dropdown-icon(name="dd-arrow-down")
  | More
button.btn-action
  cf-icon.btn-dropdown-icon(name="dd-arrow-down")
  | More
button.btn-primary-action
  cf-icon.btn-dropdown-icon(name="dd-arrow-down")
  | More

Styleguide 4.9
*/

.btn-dropdown-icon
  float: right
  margin-left: 0.4em
  margin-right: -0.2em
  svg
    display: inline-block

/*
Action Selector

Click on the lower button to toggle the state. Click on the upper arrow to toggle the dropdown.

Markup:
div(style="width: 24em")
  div.btn-action-select
    button.btn-action-select__action.is-loading
      | Publish
    button.btn-action-select__selector(cf-context-menu-trigger)
      span.btn-action-select__selector-label
        | Change actions
      cf-icon.btn-action-select__icon(name="dd-arrow-down")
    .context-menu.x--arrow-right(cf-context-menu="bottom-right")
      div(role="menuitem") Another action
  p
  div.btn-action-select.x--no-action
    button.btn-action-select__action
      | Publish
    button.btn-action-select__selector
      span.btn-action-select__selector-label
        | Change actions
      cf-icon.btn-action-select__icon(name="dd-arrow-down")
script
  | $('.btn-action-select.x--no-action').click(function () {
  |   $(this).toggleClass('x--no-action')
  | })

Styleguide 4.10
*/


.btn-action-select
  display: flex
  overflow: hidden
  border-radius: 2px

  &__selector,
  &__action
    $btn-primary()
    flex: 1 1 auto
    transition-property: all, width, padding
    transition-duration: 0.1s, 0.6s, 0.6s
    border-radius: 0

  &__action
    $x--block()
    border-right: none
    overflow: hidden
    width: 100%
    white-space: nowrap

  &__selector
    flex-shrink: 0
    width: 3.2rem
    white-space: nowrap
    overflow: hidden
    padding-left: 0
    padding-right: 0

  &__icon
    display: inline-block
    margin: 0 0.4em

  &__selector-label
    display: none


.btn-action-select.x--no-action

  .btn-action-select__action
    width: 0
    padding-left: 0
    padding-right: 0
    // This hides the border
    margin-left: -1px

  .btn-action-select__selector
    width: 100%

  .btn-action-select__selector-label
    display: inline
