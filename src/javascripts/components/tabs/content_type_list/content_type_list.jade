include ../advice.mixin.jade
include ../../shared/table_pattern.mixin.jade

header.workbench-header
  cf-breadcrumbs
  .workbench-header__left
    cf-icon.workbench-header__icon(name="page-ct", scale="0.75")
    h1.workbench-header__title
      | Content model
      cf-knowledge-base.workbench-header__kb-link(target="content_model")

  .workbench-header__search(
    ng-show="contentTypes.length > 0")
    input.cfnext-form__input(
      autofocus
      style="border: 1px solid #4A90E2; border-radius: 2px; height: 40px; padding: 0 10px"
      type="text"
      placeholder="Search for a content type"
      ng-model="context.searchTerm")

  .workbench-header__actions(ng-show="contentTypes.length > 0")
    button.btn-action(
      ng-click="newContentType()"
      ng-hide="shouldHide('createContentType')"
      ng-disabled="shouldDisable('createContentType')"
      data-test-id="create-content-type")
      cf-icon.btn-icon.inverted(name="plus")
      | Add content type

.workbench-main.x--content(ng-show="contentTypes.length < 1")
  .empty-state
    cf-icon(name="empty-content-model" class="empty-state__icon")
    .empty-state__title
      | Alright, letâ€™s create your content model!
    .empty-state__description
      | The content model is comprised of content types. They work like a stencil which defines the structure of your content. Get started by creating your first content type.
    .empty-state__action
      button.btn-action--large(
        type="button"
        ng-click="newContentType()"
        ng-hide="shouldHide('createContentType')"
        ng-disabled="shouldDisable('createContentType')"
        data-test-id="create-content-type-empty-state")
        cf-icon.btn-icon.inverted(name="plus")
        | Add content type
    .empty-state__additional
      | No clue what purpose the content model serves? Read our documentation on <cf-knowledge-base target="content_model" text="content modeling" inline-text="true" class="text-link--standard"></cf-knowledge-base>.

.workbench-main(ng-show="contentTypes.length > 0")
  .workbench-main__left-sidebar
    .view-folder
      header.view-folder__header
        .view-folder__title Filter by status
      ul.view-folder__list
        li.view-folder__item(
          ng-class="{'-active': context.list == 'all'}"
          ng-click="context.list = 'all'")
          .view-folder__item-title All
        li.view-folder__item(
          ng-class="{'-active': context.list == 'changed'}"
          ng-click="context.list = 'changed'")
          .view-folder__item-title Changed
        li.view-folder__item(
          ng-class="{'-active': context.list == 'draft'}"
          ng-click="context.list = 'draft'")
          .view-folder__item-title Draft
        li.view-folder__item(
          ng-class="{'-active': context.list == 'active'}"
          ng-click="context.list = 'active'")
          .view-folder__item-title Active

  .workbench-main__right-content
    +no-search-results("visibleContentTypes.length < 1")
    .table(ng-show="visibleContentTypes.length > 0")
      .table__head
        table
          thead
            tr
              th(aria-label="cell-display-name").x--medium-cell Name
              th(aria-label="cell-description").x--large-cell Description
              th(aria-label="cell-integer").x--small-cell Fields
              th(aria-label="cell-date").x--small-cell Updated
              th(aria-label="cell-symbol").x--small-cell By
              th(aria-label="cell-status").x--small-cell Status
      .table__body
        table
          tbody
            tr.entity-list__item(
              ng-repeat="contentType in visibleContentTypes track by contentType.sys.id"
              ng-init="linkToCt='^.detail.fields({ contentTypeId: contentType.sys.id })'"
              ui-sref="{{linkToCt}}"
              data-test-id="content-type-item")
              +td.x--medium-cell(aria-label="cell-display-name"
                ui-sref="{{linkToCt}}"
                data-test-id="cell-name")
                | {{contentType.name || '&nbsp;'}}
              +td.x--large-cell(aria-label="cell-description"
                ui-sref="{{linkToCt}}"
                data-test-id="cell-description")
                | {{contentType.description || '&nbsp;'}}
              +td.x--small-cell(aria-label="cell-integer"
                ui-sref="{{linkToCt}}"
                data-test-id="cell-fields")
                | {{numFields(contentType)}}
              +td.x--small-cell(aria-label="cell-date"
                ui-sref="{{linkToCt}}"
                data-test-id="cell-date")
                date(ng-if="contentType.sys.updatedAt" datetime="{{contentType.sys.updatedAt}}" cf-relative-datetime)
              +td.x--small-cell(aria-label="cell-symbol"
                ui-sref="{{linkToCt}}"
                data-test-id="cell-created-by")
                span(cf-user link="contentType.sys.updatedBy" as="updater")
                  | {{updater | userNameDisplay:user}}
              +td.x--small-cell(aria-label="cell-status"
                ui-sref="{{linkToCt}}"
                data-test-id="cell-status")
                <react-component name="@contentful/ui-component-library/Tag" props="{children: statusLabel(contentType), tagType: statusType(contentType)}"></react-component>
