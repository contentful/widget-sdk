include ../advice.mixin.jade

header.workbench-header
  cf-breadcrumbs
  .workbench-header__left
    cf-icon.workbench-header__icon(name="page-ct")
    h1.workbench-header__title
      | Content model
      cf-knowledge-base.workbench-header__kb-link(target="content_type")

  .workbench-header__search.search-area
    .search-field(
      cf-search="searchTerm"
      is-searching="context.isSearching"
      search-type-ahead="true"
      placeholder="Type to search")

  .workbench-header__actions
    button.btn-action(
      ng-click="entityCreationController.newContentType()"
      ng-hide="shouldHide('createContentType')"
      ng-disabled="shouldDisable('createContentType')"
      cf-when-disabled="createContentType")
      cf-icon.btn-icon.inverted(name="plus")
      | Add content type

.workbench-main.x--content(ng-show="!hasContentTypes()")
  .cfnext-advice
    header.advice__title
      | <em>{{spaceContext.space.data.name}}</em> has no content types yet
    button.btn-action--large-popout-icon.ct-empty-list__action(
      type="button"
      ng-click="entityCreationController.newContentType()"
      ng-hide="shouldHide('createContentType')"
      ng-disabled="shouldDisable('createContentType')"
      cf-when-disabled="createContentType")
      cf-icon(name="new-ct")
      | Create content type

    p.ct-empty-list__description
      | This is the first step in organizing your content <br>
      | The content type will define the structure of <em>entries</em>
      | where your content is actually stored

    p.ct-empty-list__additional
      | If you are not sure what content types and entries are, <br>
      | consider reading the&nbsp;
      cf-knowledge-base(target="content_type" text="introduction to the Contentful content model")

.workbench-main(ng-show="hasContentTypes()")
  .workbench-main__left-sidebar
    header.filter-list-header Filter By Status
    ul.status-filters
      li.filter-list-item(ng-class="{active: context.list == 'all'}" ng-click="context.list = 'all'")
        span.filter-list-title All
      li.filter-list-item(ng-class="{active: context.list == 'changed'}" ng-click="context.list = 'changed'")
        span.filter-list-title Changed
      li.filter-list-item(ng-class="{active: context.list == 'draft'}" ng-click="context.list = 'draft'")
        span.filter-list-title Draft
      li.filter-list-item(ng-class="{active: context.list == 'active'}" ng-click="context.list = 'active'")
        span.filter-list-title Active

  .workbench-main__right-content
    +no-search-results("!hasQueryResults()", "searchTerm", "context.list")
    .table(ng-show="hasQueryResults()")
      .table__head
        table
          thead
            tr
              th(aria-label="cell-display-name").x--medium-cell Name
              th(aria-label="cell-description").x--large-cell Description
              th(aria-label="cell-integer").x--small-cell Fields
              th(aria-label="cell-date").x--small-cell Updated
              th(aria-label="cell-symbol").x--small-cell By
              th(aria-label="cell-status").x--small-cell Status
      .table__body
        table
          tbody
            tr.entity-list__item(
              ng-repeat="contentType in visibleContentTypes track by contentType.getId()"
              ui-sref="spaces.detail.content_types.detail.fields({ contentTypeId: contentType.getId() })")
              td(aria-label="cell-display-name").x--medium-cell
                | {{contentType.getName()}}
              td(aria-label="cell-description").x--large-cell
                | {{contentType.data.description}}
              td(aria-label="cell-integer").x--small-cell
                | {{numFields(contentType)}}
              td(aria-label="cell-date").x--small-cell
                date(ng-if="contentType.getUpdatedAt()" datetime="{{contentType.getUpdatedAt()}}" cf-relative-datetime)
              td(aria-label="cell-symbol").x--small-cell
                span(cf-user link="contentType.getUpdatedBy()" as="updater")
                  | {{updater | userNameDisplay:user}}
              td.entity-status.x--small-cell(aria-label="cell-status" ng-class="statusClass(contentType)")
                | {{statusLabel(contentType)}}
