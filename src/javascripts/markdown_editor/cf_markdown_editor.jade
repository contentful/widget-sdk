.markdown-loading(ng-if="!isReady() && !hasCrashed")
  | Initializing Markdown editor&nbsp;
  i.fa.fa-spinner.fa-spin

.markdown-crashed(ng-if="hasCrashed")
  | Markdown editor has crashed, please refresh the page&nbsp;
  i.fa.fa-warning

.markdown-loaded(ng-class="{'visible': isReady() && !hasCrashed}")
  .markdown-tabs
    a(href ng-if="notInProduction()" ng-click="setMode('html')" ng-class="{'inactive': !inMode('html')}")
      | HTML
    a(href ng-click="setMode('rich')" ng-class="{'inactive': !inMode('rich')}")
      | Preview
    a(href ng-click="setMode('md')" ng-class="{'inactive': !inMode('md')}")
      | Editor

  .markdown-toolbar
    .markdown-actions
      button.toolbar-button.fa.fa-header(
        cf-context-menu-trigger
        tabindex="-1"
        tooltip="Headings"
        ng-disabled="!inMode('md')"
        class="markdown-headings")
        | &nbsp;
        i.fa.fa-chevron-down
      .context-menu(cf-context-menu="bottom")
        cf-icon.context-menu__arrow(name="arrow-up")
        ul.context-menu__items
          li(type="button" ng-click="actions.h1()")
            i.fa.fa-star
            |  Heading 1
          li(type="button" ng-click="actions.h2()")
            i.fa.fa-star-half-o
            |  Heading 2
          li(type="button" ng-click="actions.h3()")
            i.fa.fa-star-o
            |  Heading 3

      button.toolbar-button.fa.fa-bold(
        ng-click="actions.bold()"
        tabindex="-1"
        tooltip="Bold"
        ng-disabled="!inMode('md')")

      button.toolbar-button.fa.fa-italic(
        ng-click="actions.italic()"
        tabindex="-1"
        tooltip="Italic"
        ng-disabled="!inMode('md')")

      button.toolbar-button.fa.fa-quote-left(
        ng-click="actions.quote()"
        tabindex="-1"
        tooltip="Quote"
        ng-disabled="!inMode('md')")

      button.toolbar-button.fa.fa-list(
        ng-click="actions.ul()"
        tabindex="-1"
        tooltip="Unordered list"
        ng-disabled="!inMode('md')")

      button.toolbar-button.fa.fa-list-ol(
        ng-click="actions.ol()"
        tabindex="-1"
        tooltip="Ordered list"
        ng-disabled="!inMode('md')")

      button.toolbar-button.fa.fa-link(
        ng-click="insertLink()"
        tabindex="-1"
        tooltip="Insert link"
        ng-disabled="!inMode('md')")

      button.toolbar-button.fa.fa-ellipsis-h(
        ng-click="minorActionsShown = !minorActionsShown"
        tabindex="-1"
        tooltip="More actions..."
        class="markdown-more-actions"
        ng-class="{'active': minorActionsShown}")

      button.toolbar-button.fa.fa-picture-o(
        ng-click="insertAsset()"
        tabindex="-1"
        ng-disabled="!inMode('md')"
        class="markdown-media")
        |  Insert media

    .markdown-minor-actions(ng-show="minorActionsShown")
      button.toolbar-button.fa.fa-strikethrough(
        ng-click="actions.strike()"
        tabindex="-1"
        tooltip="Strike out"
        ng-disabled="!inMode('md')")

      button.toolbar-button.fa.fa-code(
        ng-click="actions.code()"
        tabindex="-1"
        tooltip="Code"
        ng-disabled="!inMode('md')")

      button.toolbar-button.fa.fa-arrows-h(
        ng-click="actions.hr()"
        tabindex="-1"
        tooltip="Horizontal rule"
        ng-disabled="!inMode('md')")

      button.toolbar-button.fa.fa-indent(
        ng-click="actions.indent()"
        tabindex="-1"
        tooltip="Indent"
        ng-disabled="!inMode('md')")

      button.toolbar-button.fa.fa-dedent(
        ng-click="actions.dedent()"
        tabindex="-1"
        tooltip="Dedent"
        ng-disabled="!inMode('md')")

      button.toolbar-button.fa.fa-table(
        ng-click="insertTable()"
        tabindex="-1"
        tooltip="Insert table"
        ng-disabled="!inMode('md')")

      button.toolbar-button.fa.fa-eur(
        ng-click="insertSpecial()"
        tabindex="-1"
        tooltip="Insert special character"
        ng-disabled="!inMode('md')")

      button.toolbar-button.fa.fa-sitemap(
        ng-click="organizeLinks()"
        tabindex="-1"
        tooltip="Organize links"
        ng-disabled="!inMode('md')")

      button.toolbar-button.fa.fa-undo(
        ng-click="actions.undo()"
        tabindex="-1"
        tooltip="Undo")

      button.toolbar-button.fa.fa-repeat(
        ng-click="actions.redo()"
        tabindex="-1"
        tooltip="Redo")

  .markdown-editing-area(
    tabindex="0"
    ng-show="inMode('md')")
    textarea

  .markdown-preview(
    tabindex="0"
    ng-show="inMode('rich')"
    ng-bind-html="preview"
    ng-click="setMode('md')")

  pre.markdown-html(
    ng-if="notInProduction()"
    ng-show="inMode('html')"
    ng-bind="preview"
    ng-click="setMode('md')")

  .markdown-info
    .markdown-stats
      | {{ info.words }} words,
      | {{ info.chars }} characters,
      | {{ info.time }}m reading time
    .markdown-help
      | This field supports GitHub flavoured Markdown.&nbsp;
      a(href ng-click="openHelp()") See Markdown help
