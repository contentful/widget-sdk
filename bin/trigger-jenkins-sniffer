#!/bin/bash
# This script triggers a build of the User Interface sniffer on Jenkins.
set -ex

# Trigger Jenkins Job for user-interface-sniffer
echo "Trigger Jenkins user-interface-sniffer for ${CIRCLE_SHA1}."

AUTH="cf-ci:$JENKINS_PASSWORD"
CAUSE="Triggered+by+Circle+after+E2E+run"
QUERY="token=$JENKINS_TOKEN&sha=$CIRCLE_SHA1&job=user-interface-dependent&cause=$CAUSE"
URL="https://jenkins.contentful.org/job/user-interface-sniffer/buildWithParameters?$QUERY"
CURL="curl -X POST -i -u '$AUTH' --header '$JENKINS_CRUMB' --url '$URL'"

echo $CURL
eval $CURL
