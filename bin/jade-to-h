#!/usr/bin/env node

// Convert Jade template into hyperscript
//
// Usage: bin/jade-to-h path/to/file.jade


const Jade = require('jade');
const htmlToHs = require('html-to-hyperscript').htmlToHs;
const camelCase = require('lodash').camelCase;

// Jade to HTML
const src = process.argv[2]
const html = Jade.renderFile(src)

// HTML to Hyperscript
const hsPre = htmlToHs({
  syntax: 'h',
  tabsize: 2,
  attributesSelector (item) {
    return function (props) {
      // We omit class attributes. They are already part of the
      // selector
      if (item.name !== 'className') {
        props[camelCase(item.name)] = item.value
      }
      return props
    }
  }
}, html)

// Cleanup hyperscript for linting
const hs = hsPre
  // Remove quotes from object keys
  // {
  //   "key": value -> key: value
  // }
  .replace(/\s*"\w+":\s/g, (match) => {
    return match.replace(/"/g, '');
  })
  // Replace backticks and double quotes with single quotes
  .replace(/"|`/g, '\'')

console.log(hs)
